(competition-gpu) PS C:\Users\k\competition\mlit>
 conda activate competition-gpu; python mlit.py
Loading data...
Train shape: (363924, 149)
Test shape: (112437, 149)
Feature Engineering...
ta_str2', 'money_sonota_str3', 'parking_memo', 'school_ele_name', 'school_jun_name', 'est_other_name', 'statuses', 'money_hoshou_company']
Number of features: 133
PyTorch version: 2.5.1
CUDA available: True
CUDA version: 12.1
GPU: NVIDIA GeForce RTX 4060 Ti
Performing Feature Selection...
Dropping 6 features with 0 importance: ['name_ruby', 'bukken_type', 'school_ele_code', 'school_jun_code', 'money_hoshou_company', 'free_rent_duration']
Remaining features: 127
Starting Optuna Tuning...
[I 2025-11-19 20:59:19,686] A new study created in memory with name: no-name-8ddfdd31-c76b-4c2c-8965-ce6f8e30c901
[I 2025-11-19 20:59:23,377] Trial 0 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.08236257683950712, 'num_leaves': 252, 'max_depth': 6, 'min_child_samples': 95, 'subsample': 0.7004102463647239, 'colsample_bytree': 0.7304202208316197, 'reg_alpha': 0.3586359463525943, 'reg_lambda': 0.4626253266300091}. Best is trial 0 with value: 0.472115937088013.
[I 2025-11-19 20:59:26,590] Trial 1 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.08489106021790777, 'num_leaves': 221, 'max_depth': 3, 'min_child_samples': 15, 'subsample': 0.981256318421994, 'colsample_bytree': 0.8742845653760092, 'reg_alpha': 0.6962268300163522, 'reg_lambda': 0.25940941942204765}. Best is trial 0 with value: 0.472115937088013.
[I 2025-11-19 20:59:30,025] Trial 2 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.12011861167689405, 'num_leaves': 176, 'max_depth': 4, 'min_child_samples': 93, 'subsample': 0.9653341809262014, 'colsample_bytree': 0.5641214621324222, 'reg_alpha': 0.026424085148328058, 'reg_lambda': 0.8202122238820438}. Best is trial 0 with value: 0.472115937088013.
[I 2025-11-19 20:59:33,297] Trial 3 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.23001158131399202, 'num_leaves': 102, 'max_depth': 6, 'min_child_samples': 45, 'subsample': 0.5396858288388424, 'colsample_bytree': 0.8390334228990703, 'reg_alpha': 0.43357943024219436, 'reg_lambda': 0.8884089965031845}. Best is trial 0 with value: 0.472115937088013.
[I 2025-11-19 20:59:36,492] Trial 4 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.1042163688467403, 'num_leaves': 111, 'max_depth': 4, 'min_child_samples': 46, 'subsample': 0.5328331926448959, 'colsample_bytree': 0.9773875645662209, 'reg_alpha': 0.30617624314890535, 'reg_lambda': 0.21815140746142203}. Best is trial 0 with value: 0.472115937088013.
[I 2025-11-19 20:59:39,796] Trial 5 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.16534009209709527, 'num_leaves': 152, 'max_depth': 9, 'min_child_samples': 80, 'subsample': 0.6800485995340813, 'colsample_bytree': 0.9265526381413345, 'reg_alpha': 0.15507164190720113, 'reg_lambda': 0.5852756896637086}. Best is trial 0 with value: 0.472115937088013.
[I 2025-11-19 20:59:43,002] Trial 6 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.14585924198958258, 'num_leaves': 94, 'max_depth': 3, 'min_child_samples': 90, 'subsample': 0.7538303930498326, 'colsample_bytree': 0.7020306901939828, 'reg_alpha': 0.8282736646626133, 'reg_lambda': 0.19033105077579293}. Best is trial 0 with value: 0.472115937088013.
[I 2025-11-19 20:59:46,134] Trial 7 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.2636459971933266, 'num_leaves': 130, 'max_depth': 6, 'min_child_samples': 58, 'subsample': 0.6784011029439685, 'colsample_bytree': 0.8673980135536092, 'reg_alpha': 0.6671380896126213, 'reg_lambda': 0.8566432783650294}. Best is trial 0 with value: 0.472115937088013.
[I 2025-11-19 20:59:49,409] Trial 8 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.25478012772599684, 'num_leaves': 157, 'max_depth': 6, 'min_child_samples': 83, 'subsample': 0.7102967462444553, 'colsample_bytree': 0.551520772637192, 'reg_alpha': 0.9329326102997813, 'reg_lambda': 0.6673966997769757}. Best is trial 0 with value: 0.472115937088013.
[I 2025-11-19 20:59:52,520] Trial 9 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.2739287563504171, 'num_leaves': 222, 'max_depth': 10, 'min_child_samples': 74, 'subsample': 0.5180976971542601, 'colsample_bytree': 0.5828115106836822, 'reg_alpha': 0.8795247290044825, 'reg_lambda': 0.2939111717531737}. Best is trial 0 with value: 0.472115937088013.
[I 2025-11-19 20:59:55,612] Trial 10 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.013263998529352838, 'num_leaves': 297, 'max_depth': 12, 'min_child_samples': 15, 'subsample': 0.8514646484924071, 'colsample_bytree': 0.706759807245087, 'reg_alpha': 0.45382931149935424, 'reg_lambda': 0.0025001228602491987}. Best is trial 0 with value: 0.472115937088013.
[I 2025-11-19 20:59:58,672] Trial 11 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.05488011354201798, 'num_leaves': 253, 'max_depth': 8, 'min_child_samples': 11, 'subsample': 0.9847266799592684, 'colsample_bytree': 0.7781739563101853, 'reg_alpha': 0.6609773500673335, 'reg_lambda': 0.38101713524055225}. Best is trial 0 with value: 0.472115937088013.
[I 2025-11-19 21:00:01,818] Trial 12 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.07033191421293669, 'num_leaves': 221, 'max_depth': 3, 'min_child_samples': 28, 'subsample': 0.8478185866040792, 'colsample_bytree': 0.7888601109424312, 'reg_alpha': 0.5933254396456054, 'reg_lambda': 0.44322735900959853}. Best is trial 0 with value: 0.472115937088013.
[I 2025-11-19 21:00:04,974] Trial 13 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.1923365068320499, 'num_leaves': 284, 'max_depth': 5, 'min_child_samples': 62, 'subsample': 0.8103146540551714, 'colsample_bytree': 0.6548075159115839, 'reg_alpha': 0.3262726441478194, 'reg_lambda': 0.0979927760716679}. Best is trial 0 with value: 0.472115937088013.
[I 2025-11-19 21:00:08,067] Trial 14 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.06542362338550393, 'num_leaves': 35, 'max_depth': 7, 'min_child_samples': 31, 'subsample': 0.5987365326201564, 'colsample_bytree': 0.8752491963676198, 'reg_alpha': 0.7634817954874047, 'reg_lambda': 0.5589527411133315}. Best is trial 0 with value: 0.472115937088013.
[I 2025-11-19 21:00:11,284] Trial 15 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.011095164830414825, 'num_leaves': 199, 'max_depth': 5, 'min_child_samples': 30, 'subsample': 0.8983973028288802, 'colsample_bytree': 0.994511662476446, 'reg_alpha': 0.25500157313057187, 'reg_lambda': 0.356119298177925}. Best is trial 0 with value: 0.472115937088013.
[I 2025-11-19 21:00:14,580] Trial 16 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.0983237258194141, 'num_leaves': 257, 'max_depth': 8, 'min_child_samples': 67, 'subsample': 0.6197107464388032, 'colsample_bytree': 0.6377331552879419, 'reg_alpha': 0.5699521119983284, 'reg_lambda': 0.6845807709408729}. Best is trial 0 with value: 0.472115937088013.
[I 2025-11-19 21:00:17,826] Trial 17 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.046628986084768835, 'num_leaves': 251, 'max_depth': 11, 'min_child_samples': 20, 'subsample': 0.7707493344516142, 'colsample_bytree': 0.8174479253326377, 'reg_alpha': 0.41433298208851904, 'reg_lambda': 0.46963071213943797}. Best is trial 0 with value: 0.472115937088013.
[I 2025-11-19 21:00:21,133] Trial 18 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.13368314410946744, 'num_leaves': 202, 'max_depth': 4, 'min_child_samples': 98, 'subsample': 0.9243074935489032, 'colsample_bytree': 0.7282003169159251, 'reg_alpha': 0.19775111420348335, 'reg_lambda': 0.9830620840371709}. Best is trial 0 with value: 0.472115937088013.
[I 2025-11-19 21:00:24,210] Trial 19 finished with value: 0.472115937088013 and parameters: {'learning_rate': 0.09363812696434005, 'num_leaves': 228, 'max_depth': 7, 'min_child_samples': 5, 'subsample': 0.6015285180492795, 'colsample_bytree': 0.9161900439145495, 'reg_alpha': 0.9780246641731234, 'reg_lambda': 0.24269257274795805}. Best is trial 0 with value: 0.472115937088013.
Best trial:
  Value: 0.472115937088013
  Params:
    learning_rate: 0.08236257683950712
    num_leaves: 252
    max_depth: 6
    min_child_samples: 95
    subsample: 0.7004102463647239
    colsample_bytree: 0.7304202208316197
    reg_alpha: 0.3586359463525943
    reg_lambda: 0.4626253266300091
Training Final Model with Best Params...
Fold 1
Training until validation scores don't improve for 100 rounds
[100]   training's mape: 0.471894       valid_1's mape: 0.473002
Early stopping, best iteration is:
[1]     training's mape: 0.471894       valid_1's mape: 0.473002
Fold 2
Training until validation scores don't improve for 100 rounds
[100]   training's mape: 0.472094       valid_1's mape: 0.472204
Early stopping, best iteration is:
[1]     training's mape: 0.472094       valid_1's mape: 0.472204
Fold 3
Training until validation scores don't improve for 100 rounds
[100]   training's mape: 0.472226       valid_1's mape: 0.471675
Early stopping, best iteration is:
[1]     training's mape: 0.472226       valid_1's mape: 0.471675
Fold 4
Training until validation scores don't improve for 100 rounds
[100]   training's mape: 0.472239       valid_1's mape: 0.471622
Early stopping, best iteration is:
[1]     training's mape: 0.472239       valid_1's mape: 0.471622
Fold 5
Training until validation scores don't improve for 100 rounds
[100]   training's mape: 0.472126       valid_1's mape: 0.472076
Early stopping, best iteration is:
[1]     training's mape: 0.472126       valid_1's mape: 0.472076
Final CV MAPE: 0.47211593708801297
Saved feature_importance.png
Submission saved to submission.csv
(competition-gpu) PS C:\Users\k\competition\mlit> 